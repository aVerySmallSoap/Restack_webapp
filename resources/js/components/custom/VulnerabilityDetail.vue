<script setup lang="ts">
import { Button } from '@/components/ui/button'
import { Card, CardHeader, CardTitle, CardContent, CardDescription } from '@/components/ui/card'
import { Badge } from '@/components/ui/badge'
import { ArrowLeftIcon } from 'lucide-vue-next'

defineProps<{
    vuln: Record<string, any>
}>()

const emit = defineEmits(['close'])
</script>

<template>
    <Card class="flex flex-col h-full">
        <CardHeader class="flex flex-row items-center gap-2">
            <Button
                variant="outline"
                size="icon"
                class="h-8 w-8"
                @click="emit('close')"
            >
                <ArrowLeftIcon class="h-4 w-4" />
                <span class="sr-only">Back to list</span>
            </Button>
            <CardTitle class="text-xl">Vulnerability Details</CardTitle>
        </CardHeader>
        <CardContent class="flex-1 overflow-y-auto space-y-4">
            <div>
                <h3 class="font-semibold text-lg">{{ vuln.info }}</h3>
                <CardDescription>{{ vuln.category }} / {{ vuln.module }}</CardDescription>
            </div>

            <div class="flex flex-wrap gap-2">
                <Badge variant="outline">
                    Level: {{ vuln.level }}
                </Badge>
                <Badge variant="outline">
                    Method: {{ vuln.method }}
                </Badge>
            </div>

            <div class="space-y-2">
                <h4 class="font-semibold">Path</h4>
                <pre class="text-sm bg-muted p-2 rounded-md overflow-x-auto"><code>{{ vuln.path }}</code></pre>
            </div>

            <div v-if="vuln.parameter" class="space-y-2">
                <h4 class="font-semibold">Parameter</h4>
                <pre class="text-sm bg-muted p-2 rounded-md"><code>{{ vuln.parameter }}</code></pre>
            </div>

            <div v-if="vuln.evidence" class="space-y-2">
                <h4 class="font-semibold">Evidence</h4>
                <pre class="text-sm bg-muted p-2 rounded-md overflow-x-auto"><code>{{ vuln.evidence }}</code></pre>
            </div>

        </CardContent>
    </Card>
</template>
